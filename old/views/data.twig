{% extends 'base.twig' %}

{% block content %}

    <br/>

    <div class="row">
        <div class="col-md-2">
            <div style="background-color: #2f7ed8; width: 20px; height: 20px; float: left; position: absolute; top: 10px; left: 40px; border: 1px solid black; text-align: center; font-size: 10px; color: white;">T0</div>
            <div style="float: right;">
                - Base Metals<br/>
                - Non-CS Crystals
            </div>
        </div>
        <div class="col-md-2">
            <div style="background-color: #8bbc21; width: 20px; height: 20px; float: left; position: absolute; top: 10px; left: 40px; border: 1px solid black; text-align: center; font-size: 10px; color: white;">T0</div>
            <div style="float: right;">
                - Felsic Magma<br/>
                - Noble Metals
            </div>
        </div>
        <div class="col-md-2">
            <div style="background-color: #910000; width: 20px; height: 20px; float: left; position: absolute; top: 10px; left: 40px; border: 1px solid black; text-align: center; font-size: 10px; color: white;">T1</div>
            <div style="float: right;">
                - Chiral Structures<br/>
                - Reactive Metals
            </div>
        </div>
        <div class="col-md-2">
            <div style="background-color: #1aadce; width: 20px; height: 20px; float: left; position: absolute; top: 10px; left: 40px; border: 1px solid black; text-align: center; font-size: 10px; color: white;">T1</div>
            <div style="float: right;">
                - Silicon<br/>
                - Precious Metals
            </div>
        </div>
        <div class="col-md-2">
            <div style="background-color: #f28f43; width: 20px; height: 20px; float: left; position: absolute; top: 10px; left: 40px; border: 1px solid black; text-align: center; font-size: 10px; color: white;">T2</div>
            <div style="float: right; position: absolute; right: -25px;">
                - Miniatures Electronics<br/>
                - Mechanical Parts
            </div>
        </div>
    </div>

    <br/>
    {% for char in data %}

        <div class="panel panel-default {{ char.character.heading }}">
            <div class="panel-heading">
                <a data-toggle="collapse" data-target="#collapse_{{ char.character.id }}" href="#collapse_{{ char.character.id }}">
                    {{ char.character.name }} ( {{ char.character.corp }} )
                </a>
            </div>
            <div id="collapse_{{ char.character.id }}" class="panel-collapse collapse">
                <div class="panel-body row">
                    <div class="images col-md-4">
                        <img src="https://image.eveonline.com/Corporation/{{ char.character.corpid }}_128.png"/>
                        <img src="https://image.eveonline.com/Character/{{ char.character.id }}_128.jpg"/>
                    </div>
                    <div class="data col-md-8">
                        <div class="row-fluid">
                            {% for planet in char.planets %}
                                <div class="col-md-2" style="text-align: center;">
                                    <span>{{ planet.type }}</span>
                                    {% for extractor in planet.extractors %}
                                        <div id="chart_{{ char.character.id }}_{{ planet.id }}_{{ extractor.id }}" class="chart" style="width: 120px; height: 100px;"></div>
                                    {% endfor %}

                                    <div id="chart_{{ char.character.id }}_{{ planet.id }}_launchpad"  class="launchpad-chart" style="width: 120px; height: 100px;"></div>
                                    <div>
                                        {% for content in planet.launchpad %}
                                            <div style="display: inline-block;">
                                                <div style="background-color: {{ content.color }}; width: 10px; height: 10px; float: left; border: 1px solid; margin: 4px 4px 0 0px;"></div>
                                                <div style="float: right;">{{ content.mass}}m3</div>
                                            </div>
                                        {% endfor %}
                                        <div style="display: inline-block;">
                                            <div style="background-color: #efefef; width: 10px; height: 10px; float: left; border: 1px solid; margin: 4px 4px 0 0px;"></div>
                                            <div style="float: right;">{{ planet.launchpadRemaining }}m3</div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                            {% if char.character.planetNb == 5 %}
                                <div class="col-md-2">
                                    Empty.
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
{% endblock %}

{% block script %}
    <script type="text/javascript">
        {% for char in data %}
            {% for planet in char.planets %}
                {% for extractor in planet.extractors %}
                    $('#chart_{{ char.character.id }}_{{ planet.id}}_{{ extractor.id }}').highcharts({
                        title: {
                            text: '{{ extractor.elapsed }} %',
                            verticalAlign: 'middle',
                            floating: true,
                            style: {
                                color: '#000000'
                            }
                        },
                        tooltip: {
                            enabled: false
                        },
                        credits: {
                            enabled: false
                        },
                        plotOptions: {
                            pie: {
                                dataLabels: {
                                    enabled: false
                                }
                            }
                        },
                        series: [{
                            type: 'pie',
                            data: [{
                                y: {{ extractor.elapsed }},
                                color: '#DB1702'
                            }, {
                                y: 100 - {{ extractor.elapsed }},
                                color: '#EFEFEF'
                            }]
                        }]
                    });
                {% endfor %}

                $('#chart_{{ char.character.id }}_{{ planet.id}}_launchpad').highcharts({
                    title: {
                        text: ''
                    },
                    credits: {
                        enabled: false
                    },
                    plotOptions: {
                        pie: {
                            dataLabels: {
                                enabled: false
                            }
                        }
                    },
                    series: [{
                        type: 'pie',
                        data: [
                            {% for content in planet.launchpad %}
                                {
                                    name: '{{ content.name }}',
                                    y: {{ content.mass }},
                                    color: '{{ content.color }}'
                                },
                            {% endfor %}
                            {
                                name: 'Remainig',
                                y: {{ planet.launchpadRemaining }},
                                color: '#EFEFEF'
                            }
                        ]
                    }]
                });
            {% endfor %}
        {% endfor %}
    </script>
{% endblock %}
